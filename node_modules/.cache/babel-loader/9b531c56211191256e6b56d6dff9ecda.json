{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/123/Documents/Easynet/argon-dashboard/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/123/Documents/Easynet/argon-dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"C:/Users/123/Documents/Easynet/argon-dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\123\\\\Documents\\\\Easynet\\\\argon-dashboard\\\\src\\\\views\\\\Maps.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\"; // reactstrap components\n\nimport { Card, Container, Row } from \"reactstrap\"; // core components\n\nimport Header from \"components/Headers/Header.js\";\nimport { endpoints } from \"../api-endpoints\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar MapWrapper = function MapWrapper() {\n  _s();\n\n  var mapRef = React.useRef(null);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      drivers = _useState2[0],\n      setDrivers = _useState2[1];\n\n  useEffect(function () {\n    function fetchUsers() {\n      return _fetchUsers.apply(this, arguments);\n    }\n\n    function _fetchUsers() {\n      _fetchUsers = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var fullResponse, responseJson;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(endpoints.getDrivers);\n\n              case 2:\n                fullResponse = _context.sent;\n                _context.next = 5;\n                return fullResponse.json();\n\n              case 5:\n                responseJson = _context.sent;\n                console.log(\"Created drivers>>>>>>> from headers from map\", responseJson.users);\n                setDrivers(responseJson.users);\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _fetchUsers.apply(this, arguments);\n    }\n\n    fetchUsers();\n  }, []);\n  var geoApiUrl = \"https://maps.googleapis.com/maps/api/geocode/json?key=<<MY API KEY>>&address=\";\n  doItAll(allJobs);\n\n  function doItAll(jobs) {\n    var results = [];\n    var errors = [];\n\n    function nextJob() {\n      var job = jobs.shift();\n\n      if (!job) {\n        return Promise.resolve(results);\n      }\n\n      var friendlyAddress = geoApiUrl + encodeURIComponent(job.addressLine1 + \" \" + job.postcode);\n      return makeRequest(friendlyAddress).then(function (result) {\n        if (result.results[0] === undefined || result.results[0].geometry === undefined) {\n          nextJob();\n        } else {\n          return knex(\"LOCATIONS\").returning(\"*\").insert({\n            UPRN: job.UPRN,\n            lat: result.results[0].geometry.location.lat,\n            lng: result.results[0].geometry.location.lng,\n            title: job.title,\n            postcode: job.postcode,\n            addressLine1: job.addressLine1,\n            theo_id: job.clientId\n          }).then(function (data) {\n            // console.log('KNEX CALLBACK COMING')\n            // console.log(data[0])\n            console.log(data[0]);\n            results.push(data[0]);\n            nextJob();\n          }).catch(function (err) {\n            console.log(err);\n            errors.push(job);\n          });\n        }\n      });\n    }\n\n    return nextJob();\n  }\n\n  function makeRequest(url) {\n    return new Promise(function (resolve, reject) {\n      https.get(url, function (resp) {\n        var data = \"\";\n        resp.on(\"data\", function (chunk) {\n          data += chunk;\n        }); // The whole response has been received. Print out the result.\n\n        resp.on(\"end\", function () {\n          var result = JSON.parse(data);\n          resolve(result);\n        });\n      }).on(\"error\", function (err) {\n        console.log(\"Error: \" + err.message);\n        reject(err);\n      });\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: \"600px\"\n      },\n      className: \"map-canvas\",\n      id: \"map-canvas\",\n      ref: mapRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false);\n};\n\n_s(MapWrapper, \"jA+bSBj/8F8L0AZaDKXFGAlLdQY=\");\n\n_c = MapWrapper;\n\nvar Maps = function Maps() {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Container, {\n      className: \"mt--7\",\n      fluid: true,\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col\",\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            className: \"shadow border-0\",\n            children: /*#__PURE__*/_jsxDEV(MapWrapper, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_c2 = Maps;\nexport default Maps;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MapWrapper\");\n$RefreshReg$(_c2, \"Maps\");","map":{"version":3,"names":["React","useEffect","useState","Card","Container","Row","Header","endpoints","MapWrapper","mapRef","useRef","drivers","setDrivers","fetchUsers","fetch","getDrivers","fullResponse","json","responseJson","console","log","users","geoApiUrl","doItAll","allJobs","jobs","results","errors","nextJob","job","shift","Promise","resolve","friendlyAddress","encodeURIComponent","addressLine1","postcode","makeRequest","then","result","undefined","geometry","knex","returning","insert","UPRN","lat","location","lng","title","theo_id","clientId","data","push","catch","err","url","reject","https","get","resp","on","chunk","JSON","parse","message","height","Maps"],"sources":["C:/Users/123/Documents/Easynet/argon-dashboard/src/views/Maps.js"],"sourcesContent":["\nimport React, { useEffect, useState } from \"react\";\n\n// reactstrap components\nimport { Card, Container, Row } from \"reactstrap\";\n\n// core components\nimport Header from \"components/Headers/Header.js\";\nimport { endpoints } from \"../api-endpoints\";\n\nconst MapWrapper = () => {\n  const mapRef = React.useRef(null);\n  const [drivers, setDrivers] = useState([]);\n\n  \nuseEffect(() => {\n  async function fetchUsers() {\n    const fullResponse = await fetch(endpoints.getDrivers);\n    const responseJson = await fullResponse.json();\n    console.log(\"Created drivers>>>>>>> from headers from map\", responseJson.users);\n    setDrivers(responseJson.users);\n  }\n\n  fetchUsers();\n}, []);\nvar geoApiUrl =\n  \"https://maps.googleapis.com/maps/api/geocode/json?key=<<MY API KEY>>&address=\";\n\ndoItAll(allJobs);\n\nfunction doItAll(jobs) {\n  var results = [];\n  var errors = [];\n\n  function nextJob() {\n    var job = jobs.shift();\n    if (!job) {\n      return Promise.resolve(results);\n    }\n    var friendlyAddress =\n      geoApiUrl + encodeURIComponent(job.addressLine1 + \" \" + job.postcode);\n\n    return makeRequest(friendlyAddress).then(function (result) {\n      if (\n        result.results[0] === undefined ||\n        result.results[0].geometry === undefined\n      ) {\n        nextJob();\n      } else {\n        return knex(\"LOCATIONS\")\n          .returning(\"*\")\n          .insert({\n            UPRN: job.UPRN,\n            lat: result.results[0].geometry.location.lat,\n            lng: result.results[0].geometry.location.lng,\n            title: job.title,\n            postcode: job.postcode,\n            addressLine1: job.addressLine1,\n            theo_id: job.clientId,\n          })\n          .then(function (data) {\n            // console.log('KNEX CALLBACK COMING')\n            // console.log(data[0])\n            console.log(data[0]);\n            results.push(data[0]);\n            nextJob();\n          })\n          .catch(function (err) {\n            console.log(err);\n            errors.push(job);\n          });\n      }\n    });\n  }\n  return nextJob();\n}\n\nfunction makeRequest(url) {\n  return new Promise(function (resolve, reject) {\n    https\n      .get(url, (resp) => {\n        let data = \"\";\n        resp.on(\"data\", (chunk) => {\n          data += chunk;\n        });\n        // The whole response has been received. Print out the result.\n        resp.on(\"end\", () => {\n          let result = JSON.parse(data);\n          resolve(result);\n        });\n      })\n      .on(\"error\", (err) => {\n        console.log(\"Error: \" + err.message);\n        reject(err);\n      });\n  });\n}\n  return (\n    <>\n      <div\n        style={{ height: `600px` }}\n        className=\"map-canvas\"\n        id=\"map-canvas\"\n        ref={mapRef}\n      ></div>\n    </>\n  );\n};\n\nconst Maps = () => {\n  return (\n    <>\n      <Header />\n      {/* Page content */}\n      <Container className=\"mt--7\" fluid>\n        <Row>\n          <div className=\"col\">\n            <Card className=\"shadow border-0\">\n              <MapWrapper />\n            </Card>\n          </div>\n        </Row>\n      </Container>\n    </>\n  );\n};\n\nexport default Maps;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}